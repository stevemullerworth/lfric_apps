@@ -10,7 +10,7 @@
     use function_space_collection_mod, only : function_space_collection
     use w2_to_w1_projection_kernel_mod, only : w2_to_w1_projection_kernel_type
     use adj_w2_to_w1_projection_kernel_mod, only : adj_w2_to_w1_projection_kernel_type
-    use finite_element_config_mod, only : element_order
+    use finite_element_config_mod, only : element_order_h,element_order_v
     use fs_continuity_mod, only : w1, w2
     use quadrature_xyoz_mod, only : quadrature_xyoz_type
     use constants_mod, only : i_def, r_def
@@ -38,11 +38,11 @@
     real(kind=r_def) :: MachineTol
     real(kind=r_def) :: relative_diff
 
-    vector_space_w1_ptr => function_space_collection%get_fs(mesh,element_order,w1)
-    vector_space_w2_ptr => function_space_collection%get_fs(mesh,element_order,w2)
+    vector_space_w1_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w1)
+    vector_space_w2_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w2)
     call v_w1%initialise(vector_space=vector_space_w1_ptr, name='v_w1')
     call u_w2%initialise(vector_space=vector_space_w2_ptr, name='u_w2')
-    qr_xyoz = quadrature_xyoz_type(element_order + 3,quadrature_rule)
+    qr_xyoz = quadrature_xyoz_type(MAX(element_order_h, element_order_v) + 3,quadrature_rule)
     call v_w1_input%initialise(vector_space=vector_space_w1_ptr, name='v_w1_input')
     call u_w2_input%initialise(vector_space=vector_space_w2_ptr, name='u_w2_input')
     v_w1_inner_prod = 0.0_r_def
