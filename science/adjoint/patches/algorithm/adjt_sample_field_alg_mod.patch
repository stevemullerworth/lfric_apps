@@ -10,7 +10,7 @@
     use function_space_collection_mod, only : function_space_collection
     use sample_field_kernel_mod, only : sample_field_kernel_type
     use adj_sample_field_kernel_mod, only : adj_sample_field_kernel_type
-    use finite_element_config_mod, only : element_order
+    use finite_element_config_mod, only : element_order_h,element_order_v
     use fs_continuity_mod, only : w0
     use constants_mod, only : i_def, r_def
     use setop_random_kernel_mod, only : setop_random_kernel_type
@@ -24,18 +24,15 @@
     type(field_type) :: rmultiplicity
     type(field_type) :: field_2
     type(field_type) :: field_1_input
-    type(field_type) :: rmultiplicity_input
     type(field_type) :: field_2_input
     real(kind=r_def) :: field_1_inner_prod
-    real(kind=r_def) :: rmultiplicity_inner_prod
     real(kind=r_def) :: field_2_inner_prod
     real(kind=r_def) :: inner1
     real(kind=r_def) :: field_1_field_1_input_inner_prod
-    real(kind=r_def) :: rmultiplicity_rmultiplicity_input_inner_prod
     real(kind=r_def) :: field_2_field_2_input_inner_prod
     real(kind=r_def) :: inner2
     real(kind=r_def) :: MachineTol
     real(kind=r_def) :: relative_diff
 
-    vector_space_w0_ptr => function_space_collection%get_fs(mesh,element_order,w0)
+    vector_space_w0_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w0)
     call field_1%initialise(vector_space=vector_space_w0_ptr, name='field_1')
@@ -42,29 +39,24 @@
     call rmultiplicity%initialise(vector_space=vector_space_w0_ptr, name='rmultiplicity')
     call field_2%initialise(vector_space=vector_space_w0_ptr, name='field_2')
     call field_1_input%initialise(vector_space=vector_space_w0_ptr, name='field_1_input')
-    call rmultiplicity_input%initialise(vector_space=vector_space_w0_ptr, name='rmultiplicity_input')
     call field_2_input%initialise(vector_space=vector_space_w0_ptr, name='field_2_input')
     field_1_inner_prod = 0.0_r_def
-    rmultiplicity_inner_prod = 0.0_r_def
     field_2_inner_prod = 0.0_r_def
     ! Initialise arguments and call the tangent-linear kernel.
     call invoke(setval_random(field_1), setval_x(field_1_input, field_1), setval_random(rmultiplicity), &
-&setval_x(rmultiplicity_input, rmultiplicity), setval_random(field_2), setval_x(field_2_input, field_2), &
+&setval_random(field_2), setval_x(field_2_input, field_2), &
 &sample_field_kernel_type(field_1, rmultiplicity, field_2), x_innerproduct_x(field_1_inner_prod, field_1), &
-&x_innerproduct_x(rmultiplicity_inner_prod, rmultiplicity), x_innerproduct_x(field_2_inner_prod, field_2))
+&x_innerproduct_x(field_2_inner_prod, field_2))
     inner1 = 0.0_r_def
     inner1 = inner1 + field_1_inner_prod
-    inner1 = inner1 + rmultiplicity_inner_prod
     inner1 = inner1 + field_2_inner_prod
     field_1_field_1_input_inner_prod = 0.0_r_def
-    rmultiplicity_rmultiplicity_input_inner_prod = 0.0_r_def
     field_2_field_2_input_inner_prod = 0.0_r_def
     call invoke(adj_sample_field_kernel_type(field_1, rmultiplicity, field_2), x_innerproduct_y(field_1_field_1_input_inner_prod, &
-&field_1, field_1_input), x_innerproduct_y(rmultiplicity_rmultiplicity_input_inner_prod, rmultiplicity, rmultiplicity_input), &
+&field_1, field_1_input), &
 &x_innerproduct_y(field_2_field_2_input_inner_prod, field_2, field_2_input))
     inner2 = 0.0_r_def
     inner2 = inner2 + field_1_field_1_input_inner_prod
-    inner2 = inner2 + rmultiplicity_rmultiplicity_input_inner_prod
     inner2 = inner2 + field_2_field_2_input_inner_prod
     ! Test the inner-product values for equality, allowing for the precision of the active variables
     MachineTol = SPACING(MAX(ABS(inner1), ABS(inner2)))
