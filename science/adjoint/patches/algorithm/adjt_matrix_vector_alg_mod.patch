@@ -10,7 +10,7 @@
     use function_space_collection_mod, only : function_space_collection
     use matrix_vector_kernel_mod, only : matrix_vector_kernel_type
     use adj_matrix_vector_kernel_mod, only : adj_matrix_vector_kernel_type
-    use finite_element_config_mod, only : element_order
+    use finite_element_config_mod, only : element_order_h,element_order_v
     use fs_continuity_mod, only : w0
     use operator_mod, only : operator_type
     use constants_mod, only : i_def, r_def
@@ -31,11 +31,12 @@
     real(kind=r_def) :: inner1
     real(kind=r_def) :: lhs_lhs_input_inner_prod
     real(kind=r_def) :: x_x_input_inner_prod
+    real(kind=r_def), parameter :: lhs_sf = 1.0E-3_r_def
     real(kind=r_def) :: inner2
     real(kind=r_def) :: MachineTol
     real(kind=r_def) :: relative_diff
 
-    vector_space_w0_ptr => function_space_collection%get_fs(mesh,element_order,w0)
+    vector_space_w0_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w0)
     call lhs%initialise(vector_space=vector_space_w0_ptr, name='lhs')
     call x%initialise(vector_space=vector_space_w0_ptr, name='x')
     call matrix%initialise(vector_space_w0_ptr, vector_space_w0_ptr)
@@ -48,8 +49,9 @@
 &setop_random_kernel_type(matrix), matrix_vector_kernel_type(lhs, x, matrix), x_innerproduct_x(lhs_inner_prod, lhs), &
 &x_innerproduct_x(x_inner_prod, x))
     inner1 = 0.0_r_def
-    inner1 = inner1 + lhs_inner_prod
+    inner1 = inner1 + lhs_inner_prod*lhs_sf
     inner1 = inner1 + x_inner_prod
+    call invoke(inc_a_times_X(lhs_sf, lhs))
     lhs_lhs_input_inner_prod = 0.0_r_def
     x_x_input_inner_prod = 0.0_r_def
     call invoke(adj_matrix_vector_kernel_type(lhs, x, matrix), x_innerproduct_y(lhs_lhs_input_inner_prod, lhs, lhs_input), &
